{{ if not .Site.IsServer }}
{{ with .Site.GoogleAnalytics }}
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id={{ . }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '{{ . }}', {
    page_path: window.location.pathname + window.location.search
  });

  document.addEventListener('DOMContentLoaded', function() {
    // Track Academic Profile Clicks
    const profileLinks = {
      'google_scholar': 'scholar.google',
      'orcid': 'orcid.org',
      'linkedin': 'linkedin.com',
      'bluesky': 'bsky.app'
    };

    Object.entries(profileLinks).forEach(([platform, domain]) => {
      document.querySelectorAll(`a[href*="${domain}"]`).forEach(link => {
        link.addEventListener('click', function() {
          gtag('event', 'profile_click', {
            'event_category': 'Academic Profiles',
            'event_label': platform
          });
        });
      });
    });

    // Track Email Contact
    document.querySelectorAll('a[href*="mailto"]').forEach(link => {
      link.addEventListener('click', function() {
        gtag('event', 'contact', {
          'event_category': 'Engagement',
          'event_label': 'Email Contact'
        });
      });
    });
  });
</script>
{{ end }}
{{ end }}